<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inspeccionar DOM - Buscar Mar√≠a Garc√≠a</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .found {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
        }
        .not-found {
            background-color: #e8f5e8;
            border-left: 4px solid #4caf50;
        }
        .info {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
        }
        button {
            background-color: #2196f3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #1976d2;
        }
        .danger {
            background-color: #f44336;
        }
        .danger:hover {
            background-color: #d32f2f;
        }
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Inspeccionar DOM - Buscar "Mar√≠a Garc√≠a"</h1>
        
        <div class="info">
            <strong>Prop√≥sito:</strong> Este script busca cualquier referencia a "Mar√≠a Garc√≠a" o "maria garcia" en el DOM de la aplicaci√≥n principal.
        </div>

        <button onclick="inspectMainApp()">üîç Inspeccionar Aplicaci√≥n Principal</button>
        <button onclick="inspectLocalStorage()">üíæ Inspeccionar localStorage</button>
        <button onclick="inspectSessionStorage()">üìù Inspeccionar sessionStorage</button>
        <button onclick="clearAllData()" class="danger">üóëÔ∏è Limpiar Todo</button>

        <div id="results"></div>
    </div>

    <script>
        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.innerHTML = message;
            results.appendChild(div);
        }

        function inspectMainApp() {
            document.getElementById('results').innerHTML = '';
            log('üîç Iniciando inspecci√≥n del DOM...', 'info');

            try {
                // Abrir la aplicaci√≥n principal en un iframe para inspeccionar
                const iframe = document.createElement('iframe');
                iframe.src = '/';
                iframe.style.display = 'none';
                document.body.appendChild(iframe);

                iframe.onload = function() {
                    try {
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        
                        // Buscar en todo el texto del documento
                        const bodyText = iframeDoc.body.innerText.toLowerCase();
                        const bodyHTML = iframeDoc.body.innerHTML.toLowerCase();
                        
                        log('üìÑ Contenido del documento cargado', 'info');
                        
                        // Buscar variaciones de "mar√≠a garc√≠a"
                        const searchTerms = [
                            'mar√≠a garc√≠a',
                            'maria garcia', 
                            'mar√≠a',
                            'garcia',
                            'div maria garcia'
                        ];
                        
                        let found = false;
                        searchTerms.forEach(term => {
                            if (bodyText.includes(term) || bodyHTML.includes(term)) {
                                log(`‚ùå ENCONTRADO: "${term}" en el DOM`, 'found');
                                found = true;
                            }
                        });
                        
                        if (!found) {
                            log('‚úÖ No se encontraron referencias a "Mar√≠a Garc√≠a" en el DOM', 'not-found');
                        }
                        
                        // Buscar elementos espec√≠ficos que puedan contener datos
                        const contactElements = iframeDoc.querySelectorAll('[class*="contact"], [id*="contact"], [class*="user"], [id*="user"]');
                        log(`üìã Elementos relacionados con contactos encontrados: ${contactElements.length}`, 'info');
                        
                        contactElements.forEach((el, index) => {
                            const text = el.innerText.toLowerCase();
                            if (text.includes('mar√≠a') || text.includes('garcia')) {
                                log(`‚ùå Elemento ${index + 1}: ${el.tagName} contiene datos de ejemplo`, 'found');
                                log(`<pre>${el.outerHTML.substring(0, 200)}...</pre>`, 'found');
                            }
                        });
                        
                        document.body.removeChild(iframe);
                        
                    } catch (error) {
                        log(`‚ùå Error accediendo al iframe: ${error.message}`, 'found');
                        document.body.removeChild(iframe);
                        
                        // Fallback: inspeccionar el DOM actual
                        inspectCurrentDOM();
                    }
                };
                
                iframe.onerror = function() {
                    log('‚ùå Error cargando la aplicaci√≥n principal', 'found');
                    document.body.removeChild(iframe);
                    inspectCurrentDOM();
                };
                
            } catch (error) {
                log(`‚ùå Error: ${error.message}`, 'found');
                inspectCurrentDOM();
            }
        }

        function inspectCurrentDOM() {
            log('üîç Inspeccionando DOM actual...', 'info');
            
            const bodyText = document.body.innerText.toLowerCase();
            const bodyHTML = document.body.innerHTML.toLowerCase();
            
            const searchTerms = [
                'mar√≠a garc√≠a',
                'maria garcia', 
                'mar√≠a',
                'garcia'
            ];
            
            let found = false;
            searchTerms.forEach(term => {
                if (bodyText.includes(term) || bodyHTML.includes(term)) {
                    log(`‚ùå ENCONTRADO en DOM actual: "${term}"`, 'found');
                    found = true;
                }
            });
            
            if (!found) {
                log('‚úÖ No se encontraron referencias en el DOM actual', 'not-found');
            }
        }

        function inspectLocalStorage() {
            log('üíæ Inspeccionando localStorage...', 'info');
            
            let found = false;
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                
                if (key.toLowerCase().includes('maria') || key.toLowerCase().includes('garcia') ||
                    value.toLowerCase().includes('mar√≠a') || value.toLowerCase().includes('garcia')) {
                    log(`‚ùå ENCONTRADO en localStorage: ${key}`, 'found');
                    log(`<pre>${value.substring(0, 200)}...</pre>`, 'found');
                    found = true;
                }
            }
            
            if (!found) {
                log('‚úÖ No se encontraron datos de ejemplo en localStorage', 'not-found');
            }
        }

        function inspectSessionStorage() {
            log('üìù Inspeccionando sessionStorage...', 'info');
            
            let found = false;
            for (let i = 0; i < sessionStorage.length; i++) {
                const key = sessionStorage.key(i);
                const value = sessionStorage.getItem(key);
                
                if (key.toLowerCase().includes('maria') || key.toLowerCase().includes('garcia') ||
                    value.toLowerCase().includes('mar√≠a') || value.toLowerCase().includes('garcia')) {
                    log(`‚ùå ENCONTRADO en sessionStorage: ${key}`, 'found');
                    log(`<pre>${value.substring(0, 200)}...</pre>`, 'found');
                    found = true;
                }
            }
            
            if (!found) {
                log('‚úÖ No se encontraron datos de ejemplo en sessionStorage', 'not-found');
            }
        }

        function clearAllData() {
            if (confirm('¬øEst√°s seguro de que quieres limpiar todos los datos del navegador?')) {
                localStorage.clear();
                sessionStorage.clear();
                
                // Limpiar cookies
                document.cookie.split(";").forEach(function(c) { 
                    document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); 
                });
                
                log('üóëÔ∏è Todos los datos han sido limpiados', 'info');
                log('üîÑ Recarga la p√°gina principal para verificar los cambios', 'info');
            }
        }

        // Auto-ejecutar inspecci√≥n al cargar
        window.onload = function() {
            log('üöÄ Script de inspecci√≥n cargado', 'info');
        };
    </script>
</body>
</html>